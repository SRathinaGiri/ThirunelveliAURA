<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Krishi Mitra</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
    .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
    .header { background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%); color: white; padding: 30px; text-align: center; border-radius: 20px 20px 0 0; position: relative; }
    .header h1 { font-size: 2.5em; margin-bottom: 10px; }
    .user-info { position: absolute; top: 15px; right: 20px; background: rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 20px; font-size: 0.9em; display: none; }
    .content { padding: 40px; }
    .page { display: none; }
    .page.active { display: block; }
    h2 { color: #27ae60; text-align: center; margin-bottom: 20px; font-size: 2em; }
    .login-box { max-width: 450px; margin: 0 auto; text-align: center; }
    .login-box h2 { margin-bottom: 30px; }
    .login-box p { color: #666; margin-bottom: 30px; font-size: 1.1em; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin: 30px 0; }
    .card { background: white; border: 3px solid #ddd; padding: 25px; border-radius: 15px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: relative; }
    .card:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.2); border-color: #27ae60; }
    .card.selected { border-color: #27ae60; background: #d4edda; border-width: 5px; }
    .card h3 { color: #27ae60; margin-bottom: 12px; font-size: 1.4em; }
    .card p { color: #666; line-height: 1.6; }
    .checkmark { position: absolute; top: 10px; right: 10px; background: #27ae60; color: white; width: 30px; height: 30px; border-radius: 50%; display: none; align-items: center; justify-content: center; font-weight: bold; }
    .card.selected .checkmark { display: flex; }
    .btn { background: linear-gradient(135deg, #27ae60 0%, #229954 100%); color: white; border: none; padding: 18px 40px; border-radius: 50px; cursor: pointer; font-size: 18px; font-weight: 600; margin: 20px 10px; width: 100%; max-width: 400px; }
    .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(39, 174, 96, 0.3); }
    .btn-back { background: #6c757d; width: auto; }
    .button-group { text-align: center; margin-top: 30px; }
    .input-group { margin: 25px 0; text-align: left; }
    .input-group label { display: block; color: #2c3e50; font-weight: 600; margin-bottom: 10px; font-size: 1.1em; }
    .input-group input, .input-group select { width: 100%; padding: 15px; border: 3px solid #ddd; border-radius: 10px; font-size: 16px; }
    .input-group input:focus, .input-group select:focus { outline: none; border-color: #27ae60; box-shadow: 0 0 10px rgba(39,174,96,0.2); }
    .input-group small { color: #666; font-size: 0.9em; margin-top: 5px; display: block; }
    .info-box { background: #f8f9fa; border-radius: 15px; padding: 30px; margin: 25px 0; }
    .info-box h3 { color: #27ae60; margin-bottom: 20px; font-size: 1.6em; }
    .crop-section { background: white; border-radius: 15px; padding: 25px; margin: 20px 0; border: 3px solid #27ae60; }
    .crop-section h4 { color: #27ae60; font-size: 1.5em; margin-bottom: 15px; }
    .step { background: white; padding: 18px; margin: 15px 0; border-radius: 12px; border-left: 6px solid #27ae60; box-shadow: 0 3px 8px rgba(0,0,0,0.08); }
    .budget-row { background: white; padding: 18px; margin: 12px 0; border-radius: 12px; display: flex; justify-content: space-between; box-shadow: 0 3px 8px rgba(0,0,0,0.08); font-size: 1.1em; }
    .budget-row.total { background: #27ae60; color: white; font-weight: bold; font-size: 1.4em; }
    .reminder { background: white; border-radius: 15px; padding: 22px; margin: 18px 0; border-left: 6px solid #3498db; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .reminder.urgent { border-left-color: #e74c3c; background: #fff5f5; }
    .alert { background: #fff3cd; border: 2px solid #ffc107; border-radius: 12px; padding: 18px; margin: 20px 0; color: #856404; }
    .success { background: #d4edda; border: 2px solid #28a745; border-radius: 12px; padding: 18px; margin: 20px 0; color: #155724; text-align: center; }
    .selected-crops { background: #e3f2fd; border: 2px solid #2196f3; border-radius: 12px; padding: 15px; margin: 20px 0; color: #0d47a1; }
    @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } .content { padding: 25px; } }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üåæ ‡§ï‡•É‡§∑‡§ø ‡§Æ‡§ø‡§§‡•ç‡§∞ - Krishi Mitra</h1>
      <p>Complete Guide - Crops & All Vegetables of India by ANTONEY WINSON</p>
      <div class="user-info" id="userInfo"></div>
    </div>
    <div class="content">
      <!-- p0: Login -->
      <div id="p0" class="page active">
        <div class="login-box">
          <h2>‡§®‡§Æ‡§∏‡•ç‡§§‡•á ‡§ï‡§ø‡§∏‡§æ‡§® ‡§≠‡§æ‡§à! üôè</h2>
          <p>Welcome to your complete farming guide</p>
          <div class="input-group">
            <label>üë§ Your Name: *</label>
            <input type="text" id="fname" placeholder="Enter your name">
          </div>
          <div class="input-group">
            <label>üì± Mobile Number:</label>
            <input type="tel" id="fphone" placeholder="10 digit (optional)" maxlength="10">
            <small>Optional - for alerts</small>
          </div>
          <div class="input-group">
            <label>üìç State: *</label>
            <select id="fstate">
              <option value="">Select state</option>
              <option value="Andhra Pradesh">Andhra Pradesh</option>
              <option value="Bihar">Bihar</option>
              <option value="Gujarat">Gujarat</option>
              <option value="Haryana">Haryana</option>
              <option value="Karnataka">Karnataka</option>
              <option value="Kerala">Kerala</option>
              <option value="Madhya Pradesh">Madhya Pradesh</option>
              <option value="Maharashtra">Maharashtra</option>
              <option value="Punjab">Punjab</option>
              <option value="Rajasthan">Rajasthan</option>
              <option value="Tamil Nadu">Tamil Nadu</option>
              <option value="Telangana">Telangana</option>
              <option value="Uttar Pradesh">Uttar Pradesh</option>
              <option value="West Bengal">West Bengal</option>
            </select>
          </div>
          <button class="btn" onclick="login()">Start Journey ‚Üí</button>
        </div>
      </div>

      <!-- p1: Soil -->
      <div id="p1" class="page">
        <h2>Select Soil Type</h2>
        <div class="alert"><strong>üí° Soil Types:</strong> Alluvial, Black, Red, Laterite, Desert, Mountain</div>
        <div class="grid" id="sg"></div>
        <div class="button-group"><button class="btn" onclick="gp2()">Next ‚Üí</button></div>
      </div>

      <!-- p2: Crops -->
      <div id="p2" class="page">
        <h2>Select Crops & Vegetables</h2>
        <div class="success"><strong>‚úÖ Select multiple items</strong></div>
        <div class="selected-crops" id="si" style="display:none;"><strong>Selected:</strong> <span id="sl"></span></div>
        <div class="grid" id="cg"></div>
        <div class="button-group"><button class="btn btn-back" onclick="gp1()">‚Üê Back</button><button class="btn" onclick="gp3()">Next ‚Üí</button></div>
      </div>

      <!-- p3: Area -->
      <div id="p3" class="page">
        <h2>Land Area for Each</h2>
        <div class="alert"><strong>üìê</strong> 1 Acre = 4,047 sqm | 1 Hectare = 10,000 sqm</div>
        <div id="ai"></div>
        <div class="button-group"><button class="btn btn-back" onclick="gp2()">‚Üê Back</button><button class="btn" onclick="gp4()">See Guide ‚Üí</button></div>
      </div>

      <!-- p4: Guide + Budget + Links -->
      <div id="p4" class="page">
        <h2>Complete Guide</h2>
        <div class="success"><strong>üéâ Guide ready!</strong></div>
        <div id="ag"></div>
        <div class="info-box"><h3>üí∞ Total Budget</h3><div id="tb"></div></div>
        <div class="info-box"><h3>‚è∞ Reminders</h3><button class="btn" onclick="en()">üîî Enable</button><div id="ar"></div></div>
        <div class="info-box"><h3>üåê Useful links</h3><div id="links"></div></div>
        <div class="button-group"><button class="btn" onclick="rs()">Start Over üîÑ</button></div>
      </div>
    </div>
  </div>

  <script>
    // ----- Data -----
    var d = { n:'', ph:'', st:'', s:'', c:[], a:{} };

    var so = {
      alluvial:{n:'Alluvial Soil',de:'Fertile valleys',cr:['Rice','Wheat','Maize','Sugarcane','Tomato','Potato','Onion','Cabbage','Cauliflower','Brinjal','Okra','Cucumber','Pumpkin','Spinach','Coriander','Carrot','Radish','Peas','Beans','Lettuce','Methi']},
      black:{n:'Black Soil',de:'Cotton belt',cr:['Cotton','Wheat','Chickpea','Groundnut','Tomato','Brinjal','Chilli','Onion','Garlic','Okra','Cabbage','Cauliflower','Coriander']},
      red:{n:'Red Soil',de:'Well-drained',cr:['Groundnut','Cotton','Maize','Tomato','Potato','Chilli','Brinjal','Beans','Carrot','Radish','Sweet Potato']},
      laterite:{n:'Laterite Soil',de:'High rainfall',cr:['Tea','Coffee','Cashew','Ginger','Turmeric','Tapioca','Pineapple','Banana','Papaya']},
      desert:{n:'Desert Soil',de:'Sandy',cr:['Bajra','Cotton','Carrot','Radish','Turnip','Cluster Beans']},
      mountain:{n:'Mountain Soil',de:'Forest soil',cr:['Tea','Coffee','Potato','Cabbage','Cauliflower','Peas','Beans','Ginger','Turmeric','Mushroom']}
    };

    var cr = {
      Rice:{h:'‡§ß‡§æ‡§®',st:['Plough 2-3 times','Choose varieties','Prepare nursery','Transplant at 25-30 days','Maintain water 5-10cm','Apply NPK 120:60:60','Remove weeds','Monitor pests','Harvest when golden'],bu:{s:0.5,f:2,p:1,l:3,w:1.5,t:8},ta:[{d:1,t:'Prepare nursery',u:1},{d:25,t:'Transplant',u:1},{d:120,t:'Harvest!',u:1}]},
      Wheat:{h:'‡§ó‡•á‡§π‡•Ç‡§Ç',st:['Deep ploughing','Use certified seeds','Treat seeds','Sow at 5cm','Irrigate after 20 days','Apply NPK','Weed control','Watch rust','Harvest'],bu:{s:0.4,f:1.8,p:0.8,l:2.5,w:1,t:6.5},ta:[{d:1,t:'Sow',u:1},{d:20,t:'First irrigation',u:1},{d:120,t:'Harvest!',u:1}]},
      Cotton:{h:'‡§ï‡§™‡§æ‡§∏',st:['Summer ploughing','Treat seeds','Sow 2-3 seeds','Thin to 1 plant','Irrigate','Apply NPK','Monitor bollworms','Prune','Pick when open'],bu:{s:0.6,f:2.5,p:2,l:4,w:1.5,t:10.6},ta:[{d:1,t:'Sow',u:1},{d:60,t:'Check pests',u:1},{d:150,t:'Picking',u:1}]},
      Maize:{h:'‡§Æ‡§ï‡•ç‡§ï‡§æ',st:['Fine tilth','Hybrids','Sow 2 seeds','Thin after 15 days','Irrigate','Apply NPK','Weed','Watch borers','Harvest'],bu:{s:0.7,f:2,p:1,l:2.8,w:1.2,t:7.7},ta:[{d:1,t:'Sow',u:1},{d:45,t:'Fertilizer',u:1},{d:90,t:'Harvest!',u:1}]},
      Chickpea:{h:'‡§ö‡§®‡§æ',st:['Deep ploughing','Good variety','Rhizobium','Sow','Irrigate at flowering','Apply NPK','Weed','Watch borer','Harvest'],bu:{s:0.8,f:1.2,p:0.8,l:2,w:0.8,t:5.6},ta:[{d:1,t:'Sow',u:1},{d:45,t:'Irrigate',u:1},{d:110,t:'Harvest!',u:1}]},
      Groundnut:{h:'‡§Æ‡•Ç‡§Ç‡§ó‡§´‡§≤‡•Ä',st:['Ridges','Certified seeds','Treatment','Sow','Irrigate','Apply NPK','Earth up','Watch disease','Harvest'],bu:{s:1.5,f:1.5,p:1,l:3,w:1,t:8},ta:[{d:1,t:'Sow',u:1},{d:30,t:'Earth up',u:1},{d:110,t:'Harvest!',u:1}]},
      Sugarcane:{h:'‡§ó‡§®‡•ç‡§®‡§æ',st:['Deep ploughing','3-bud setts','Treatment','Plant','Irrigation','Apply NPK','Earth up','Weed','Harvest'],bu:{s:3,f:4,p:1.5,l:5,w:2.5,t:16},ta:[{d:1,t:'Plant',u:1},{d:120,t:'Earth up',u:1},{d:360,t:'Harvest!',u:1}]},
      Tea:{h:'‡§ö‡§æ‡§Ø',st:['Slopes','Plant monsoon','Shade','Pruning','Irrigation','Manure','Pest control','Pluck after 3 years','Regular harvest'],bu:{s:5,f:3,p:2,l:6,w:2,t:18},ta:[{d:1,t:'Plant',u:1},{d:365,t:'Care',u:0}]},
      Coffee:{h:'‡§ï‡•â‡§´‡§º‡•Ä',st:['Shade area','Plant monsoon','Shade','Water','Compost','Pruning','Pest control','Harvest 3-4 years','Pick berries'],bu:{s:6,f:3.5,p:2.5,l:7,w:2,t:21},ta:[{d:1,t:'Plant',u:1},{d:365,t:'Care',u:0}]},
      Cashew:{h:'‡§ï‡§æ‡§ú‡•Ç',st:['Pits 60cm','Seedlings','Water','Manure','Prune','Pest control','Mulch','Harvest 3 years','Collect nuts'],bu:{s:4,f:2.5,p:2,l:5,w:1.5,t:15},ta:[{d:1,t:'Plant',u:1},{d:365,t:'Care',u:0}]},
      Bajra:{h:'‡§¨‡§æ‡§ú‡§∞‡§æ',st:['Plough','Varieties','Sow','Thin','Light irrigation','Minimal fertilizer','Weed','Watch pests','Harvest'],bu:{s:0.3,f:1,p:0.5,l:2,w:0.5,t:4.3},ta:[{d:1,t:'Sow',u:1},{d:80,t:'Harvest!',u:1}]},
      Tomato:{h:'‡§ü‡§Æ‡§æ‡§ü‡§∞',st:['Nursery beds','Sow, transplant 4 weeks','Spacing 60x45cm','Stakes','Drip irrigation','Apply NPK 150:75:100','Remove shoots','Watch borers','Pick when colored'],bu:{s:1,f:3,p:2,l:4,w:2,t:12},ta:[{d:1,t:'Sow',u:1},{d:35,t:'Transplant',u:1},{d:95,t:'Harvest!',u:1}]},
      Potato:{h:'‡§Ü‡§≤‡•Ç',st:['Ridges','Disease-free tubers','Sprout','Plant 5-7cm','Earth up 25-30 days','Apply NPK 150:100:100','Regular irrigation','Watch blight','Harvest'],bu:{s:2.5,f:2.5,p:1.5,l:3.5,w:1.5,t:11.5},ta:[{d:1,t:'Plant',u:1},{d:28,t:'Earth up',u:1},{d:100,t:'Harvest!',u:1}]},
      Onion:{h:'‡§™‡•ç‡§Ø‡§æ‡§ú',st:['Nursery','Transplant seedlings','Spacing 15x10cm','Light irrigation','Apply NPK 100:50:50','Weed 45 days','Monitor thrips','Stop irrigation 10 days','Harvest'],bu:{s:0.5,f:2.2,p:1.2,l:3.8,w:1.5,t:9.2},ta:[{d:1,t:'Sow',u:1},{d:50,t:'Transplant',u:1},{d:150,t:'Harvest!',u:1}]},
      Cabbage:{h:'‡§¨‡§Ç‡§¶‡§ó‡•ã‡§≠‡•Ä',st:['Seedbed','Transplant 4 weeks','Spacing 45x45cm','Deep watering','Apply NPK 120:60:60','Earth up','Watch caterpillars','Neem spray','Harvest firm'],bu:{s:0.8,f:2.5,p:1.5,l:3,w:1.8,t:9.6},ta:[{d:1,t:'Sow',u:1},{d:30,t:'Transplant',u:1},{d:90,t:'Harvest!',u:1}]},
      Cauliflower:{h:'‡§´‡•Ç‡§≤‡§ó‡•ã‡§≠‡•Ä',st:['Nursery','Transplant 4-5 weeks','Spacing 60x45cm','Regular irrigation','Apply NPK','Tie leaves','Watch aphids','Blanching','Harvest firm'],bu:{s:0.8,f:2.5,p:1.5,l:3.2,w:1.8,t:9.8},ta:[{d:1,t:'Sow',u:1},{d:35,t:'Transplant',u:1},{d:100,t:'Harvest!',u:1}]},
      Brinjal:{h:'‡§¨‡•à‡§Ç‡§ó‡§®',st:['Nursery','Transplant 6 weeks','Spacing 75x60cm','Staking','Apply NPK 100:50:50','Regular irrigation','Watch borer','Remove shoots','Harvest shiny'],bu:{s:0.6,f:2.8,p:2,l:3.5,w:1.8,t:10.7},ta:[{d:1,t:'Sow',u:1},{d:45,t:'Transplant',u:1},{d:120,t:'Harvest!',u:1}]},
      Chilli:{h:'‡§Æ‡§ø‡§∞‡•ç‡§ö',st:['Nursery','Transplant 6-8 weeks','Spacing 60x45cm','Mulch','Apply NPK 100:50:50','Drip irrigation','Watch thrips','Neem spray','Multiple pickings'],bu:{s:0.5,f:2.5,p:1.8,l:3.5,w:1.5,t:9.8},ta:[{d:1,t:'Sow',u:1},{d:50,t:'Transplant',u:1},{d:90,t:'First pick',u:1}]},
      Okra:{h:'‡§≠‡§ø‡§Ç‡§°‡•Ä',st:['Direct sowing','2 seeds','Spacing 60x30cm','Thin to 1','Light irrigation','Apply NPK 80:40:40','Weed','Watch mosaic','Harvest tender'],bu:{s:0.6,f:1.8,p:1.2,l:2.8,w:1.2,t:7.6},ta:[{d:1,t:'Sow',u:1},{d:45,t:'First harvest',u:1}]},
      Cucumber:{h:'‡§ñ‡•Ä‡§∞‡§æ',st:['Beds/mounds','2-3 seeds','Spacing 90x60cm','Trellis','Drip irrigation','Apply NPK 100:50:50','Mulch','Watch mildew','Harvest tender'],bu:{s:0.7,f:2.2,p:1.5,l:3,w:1.8,t:9.2},ta:[{d:1,t:'Sow',u:1},{d:40,t:'Trellis',u:1},{d:50,t:'Harvest',u:1}]},
      Pumpkin:{h:'‡§ï‡§¶‡•ç‡§¶‡•Ç',st:['Mounds 3-4ft','3-4 seeds','Thin to 2','Space needed','Root irrigation','Apply NPK 80:40:40','Pollination','Watch flies','Harvest mature'],bu:{s:0.8,f:2,p:1.2,l:2.5,w:1.5,t:8},ta:[{d:1,t:'Sow',u:1},{d:100,t:'Harvest!',u:1}]},
      Spinach:{h:'‡§™‡§æ‡§≤‡§ï',st:['Broadcast/lines','Fine tilth','Spacing 20x5cm','Light irrigation','Nitrogen manure','Multiple cuttings','Watch miners','First cut 25-30 days','Every 15 days'],bu:{s:0.3,f:1.5,p:0.8,l:2,w:1,t:5.6},ta:[{d:1,t:'Sow',u:0},{d:30,t:'First cut',u:1}]},
      Coriander:{h:'‡§ß‡§®‡§ø‡§Ø‡§æ',st:['Broadcast','Fine seedbed','Light irrigation','Compost','Minimal care','Watch aphids','Harvest 40-45 days','Multiple cuts','Before flowering'],bu:{s:0.4,f:1.2,p:0.6,l:1.8,w:0.8,t:4.8},ta:[{d:1,t:'Sow',u:0},{d:40,t:'Harvest',u:1}]},
      Carrot:{h:'‡§ó‡§æ‡§ú‡§∞',st:['Deep loose soil','Direct sowing','Spacing 30x5cm','Thin','Light irrigation','Apply NPK 50:50:50','Weed carefully','Watch blight','Harvest 90-100 days'],bu:{s:0.5,f:1.8,p:1,l:2.5,w:1.2,t:7},ta:[{d:1,t:'Sow',u:1},{d:20,t:'Thin',u:1},{d:95,t:'Harvest!',u:1}]},
      Radish:{h:'‡§Æ‡•Ç‡§≤‡•Ä',st:['Light soil','Direct sowing','Spacing 30x5cm','Fast growing','Frequent irrigation','Compost','Minimal fertilizer','Watch aphids','30-40 days'],bu:{s:0.4,f:1.2,p:0.6,l:1.8,w:0.8,t:4.8},ta:[{d:1,t:'Sow',u:0},{d:35,t:'Harvest!',u:1}]},
      Peas:{h:'‡§Æ‡§ü‡§∞',st:['Well-drained soil','Direct sowing','Spacing 30x5cm','Support for climbers','Light irrigation','Apply NPK 20:60:40','Minimal nitrogen','Watch aphids','Harvest tender'],bu:{s:1,f:1.5,p:0.8,l:2.5,w:1,t:6.8},ta:[{d:1,t:'Sow',u:1},{d:60,t:'First pick',u:1}]},
      Beans:{h:'‡§¨‡•Ä‡§®‡•ç‡§∏',st:['Direct sowing','2 seeds per spot','Spacing 45x15cm','Support if climbing','Regular irrigation','Apply NPK 25:50:25','Weed','Watch beetles','Harvest tender'],bu:{s:0.8,f:1.8,p:1,l:2.8,w:1.2,t:7.6},ta:[{d:1,t:'Sow',u:1},{d:50,t:'First harvest',u:1}]},
      Garlic:{h:'‡§≤‡§π‡§∏‡•Å‡§®',st:['Separate cloves','Plant pointed up','Spacing 15x10cm','Shallow planting','Light irrigation','Apply compost','Minimal care','Watch thrips','Harvest when dry'],bu:{s:1.2,f:1.5,p:0.8,l:2.5,w:1,t:7},ta:[{d:1,t:'Plant',u:1},{d:150,t:'Harvest!',u:1}]},
      Ginger:{h:'‡§Ö‡§¶‡§∞‡§ï',st:['Rhizome pieces','Raised beds','Spacing 30x20cm','Shade 50%','Heavy watering','Organic manure','Mulch heavily','Watch rot','Harvest 8 months'],bu:{s:3,f:3,p:1.5,l:4,w:2.5,t:14},ta:[{d:1,t:'Plant',u:1},{d:240,t:'Harvest!',u:1}]},
      Turmeric:{h:'‡§π‡§≤‡•ç‡§¶‡•Ä',st:['Rhizome pieces','Raised beds','Spacing 30x20cm','Partial shade','Regular watering','Organic manure','Mulch','Watch rot','Harvest 9 months'],bu:{s:3.5,f:3.2,p:1.5,l:4.5,w:2.8,t:15.5},ta:[{d:1,t:'Plant',u:1},{d:270,t:'Harvest!',u:1}]},
      Lettuce:{h:'‡§∏‡§≤‡§æ‡§¶ ‡§™‡§§‡•ç‡§§‡§æ',st:['Seedbed','Transplant 3 weeks','Spacing 30x30cm','Frequent irrigation','Rich compost','Light fertilizer','Watch slugs','Cool season','Harvest leaves'],bu:{s:0.4,f:1.5,p:0.8,l:2,w:1.3,t:6},ta:[{d:1,t:'Sow',u:0},{d:50,t:'Harvest',u:1}]},
      Methi:{h:'‡§Æ‡•á‡§•‡•Ä',st:['Broadcast/lines','Fine tilth','Spacing 20x5cm','Light irrigation','Nitrogen rich','Multiple cuttings','Watch aphids','First cut 25 days','Repeat cutting'],bu:{s:0.3,f:1.2,p:0.6,l:1.5,w:0.8,t:4.4},ta:[{d:1,t:'Sow',u:0},{d:25,t:'First cut',u:1}]},
      'Sweet Potato':{h:'‡§∂‡§ï‡§∞‡§ï‡§Ç‡§¶',st:['Vine cuttings 25cm','Raised ridges','Spacing 60x30cm','Plant slanted','Regular watering','Apply compost','Earth up','Watch weevils','Harvest 4 months'],bu:{s:1.8,f:2,p:1,l:3,w:1.5,t:9.3},ta:[{d:1,t:'Plant vines',u:1},{d:120,t:'Harvest!',u:1}]},
      Tapioca:{h:'‡§ü‡•à‡§™‡§ø‡§ì‡§ï‡§æ',st:['Stem cuttings 20cm','Plant slanted','Spacing 90x90cm','Drought tolerant','Minimal irrigation','Light fertilizer','Weed initially','Pest resistant','Harvest 8-10 months'],bu:{s:2,f:1.5,p:0.5,l:2.5,w:1,t:7.5},ta:[{d:1,t:'Plant',u:1},{d:270,t:'Harvest!',u:1}]},
      Pineapple:{h:'‡§Ö‡§®‡§æ‡§®‡§æ‡§∏',st:['Suckers/slips','Well-drained beds','Spacing 60x30cm','Shallow planting','Moderate water','Balanced fertilizer','Weed control','Watch mealybugs','Harvest ~18 months'],bu:{s:2.5,f:2,p:1,l:3,w:1.5,t:10.5},ta:[{d:1,t:'Plant',u:1},{d:540,t:'Harvest!',u:1}]},
      Banana:{h:'‡§ï‡•á‡§≤‡§æ',st:['Suckers','Spacing 2x2m','Irrigation','Mulch','Fertilization','Propping','Desuckering','Watch wilt','Harvest 10-12 months'],bu:{s:4,f:3,p:2,l:5,w:2.5,t:16.5},ta:[{d:1,t:'Plant',u:1},{d:360,t:'Harvest!',u:1}]},
      Papaya:{h:'‡§™‡§™‡•Ä‡§§‡§æ',st:['Seedlings','Spacing 2x2m','Irrigation','Fertilizer','Male-female plants','Fruit thinning','Watch mites','Harvest 8-12 months'],bu:{s:2.5,f:2,p:1.5,l:3.5,w:1.8,t:11.3},ta:[{d:1,t:'Plant',u:1},{d:300,t:'Harvest!',u:1}]},
      Turnip:{h:'‡§∂‡§≤‡§ó‡§Æ',st:['Direct sowing','Spacing 30x10cm','Light irrigation','Thin seedlings','Watch aphids','Harvest 45-60 days'],bu:{s:0.4,f:1,p:0.6,l:1.5,w:0.8,t:4.3},ta:[{d:1,t:'Sow',u:0},{d:50,t:'Harvest',u:1}]},
      'Cluster Beans':{h:'‡§ó‡•ç‡§µ‡§æ‡§∞',st:['Direct sowing','Spacing 45x15cm','Light irrigation','Minimal fertilizer','Watch blight','Harvest tender pods'],bu:{s:0.6,f:1.2,p:0.8,l:2,w:1,t:5.6},ta:[{d:1,t:'Sow',u:1},{d:60,t:'Harvest',u:1}]},
      Mushroom:{h:'‡§Æ‡§∂‡§∞‡•Ç‡§Æ',st:['Spawn purchase','Substrate prep','Maintain humidity','Clean environment','Harvest flushes'],bu:{s:2,f:1.5,p:1,l:2.5,w:1,t:8},ta:[{d:1,t:'Set up',u:1}]}
    };

    // ----- State-specific links -----
    const stateLinks = {
      "Andhra Pradesh": {
        buy: [
          { name: "AP Agros (Govt. agri inputs)", url: "https://apagros.ap.gov.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "eNAM", url: "https://enam.gov.in" },
          { name: "AP Markfed", url: "https://apmarkfed.ap.gov.in" }
        ]
      },
      "Bihar": {
        buy: [
          { name: "Bihar Agri Dept", url: "https://state.bihar.gov.in/agr" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "eNAM", url: "https://enam.gov.in" },
          { name: "Bihar State Agricultural Marketing Board", url: "http://www.bsambltd.com" }
        ]
      },
      "Gujarat": {
        buy: [
          { name: "Gujarat Seed Certification", url: "https://agri.gujarat.gov.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "eNAM", url: "https://enam.gov.in" },
          { name: "Gujarat State Agricultural Marketing Board", url: "https://gsamb.gujarat.gov.in" }
        ]
      },
      "Haryana": {
        buy: [
          { name: "Haryana Seeds Development Corp", url: "https://haryanaseeds.gov.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "eNAM", url: "https://enam.gov.in" },
          { name: "Haryana State Agricultural Marketing Board", url: "https://hsamb.gov.in" }
        ]
      },
      "Karnataka": {
        buy: [
          { name: "KSSC (Karnataka State Seeds)", url: "https://www.krishimaratavahini.kar.nic.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "eNAM", url: "https://enam.gov.in" },
          { name: "Karnataka Agricultural Marketing", url: "https://www.krishimaratavahini.kar.nic.in" }
        ]
      },
      "Kerala": {
        buy: [
          { name: "Kerala Agro Industries", url: "https://keralaagroindustries.com" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "eNAM", url: "https://enam.gov.in" },
          { name: "Horticorp Kerala", url: "https://horticorp.com" }
        ]
      },
      "Madhya Pradesh": {
        buy: [
          { name: "MP Agro", url: "https://mpagro.org" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "eNAM", url: "https://enam.gov.in" },
          { name: "MP State Agricultural Marketing Board", url: "https://www.mpsamb.com" }
        ]
      },
      "Maharashtra": {
        buy: [
          { name: "MAHA-Agri Dept", url: "https://mahapariksha.gov.in/Agri" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "MSAMB", url: "https://www.msamb.com" },
          { name: "eNAM", url: "https://enam.gov.in" }
        ]
      },
      "Punjab": {
        buy: [
          { name: "Punjab Agro", url: "https://punjabagro.gov.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "Punjab Mandi Board", url: "https://mandiboard.nic.in" },
          { name: "eNAM", url: "https://enam.gov.in" }
        ]
      },
      "Rajasthan": {
        buy: [
          { name: "RAJFED/RSAMB resources", url: "https://agriculture.rajasthan.gov.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "RSAMB", url: "https://rsamb.rajasthan.gov.in" },
          { name: "eNAM", url: "https://enam.gov.in" }
        ]
      },
      "Tamil Nadu": {
        buy: [
          { name: "TNAU Agritech Portal", url: "https://agritech.tnau.ac.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "TN Agricultural Marketing Board", url: "https://www.agrimark.tn.gov.in" },
          { name: "eNAM", url: "https://enam.gov.in" }
        ]
      },
      "Telangana": {
        buy: [
          { name: "TS Agros", url: "https://tsagros.telangana.gov.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "Telangana MEPMA/Marketing", url: "https://tsmarketing.telangana.gov.in" },
          { name: "eNAM", url: "https://enam.gov.in" }
        ]
      },
      "Uttar Pradesh": {
        buy: [
          { name: "UP Agro", url: "https://upagro.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "UP Mandi Parishad", url: "http://upmandiparishad.upsdc.gov.in" },
          { name: "eNAM", url: "https://enam.gov.in" }
        ]
      },
      "West Bengal": {
        buy: [
          { name: "WB Agro", url: "https://wbagrimarketingboard.gov.in" },
          { name: "IFFCO eBazar", url: "https://iffcobazar.in" },
          { name: "BigHaat", url: "https://www.bighaat.com" }
        ],
        sell: [
          { name: "WB State Marketing Board", url: "https://wbagrimarketingboard.gov.in" },
          { name: "eNAM", url: "https://enam.gov.in" }
        ]
      }
    };

    // ----- Helpers -----
    function showPage(id) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }
    function fmtMoney(x) { return '‚Çπ ' + x.toFixed(2) + 'k'; }
    function cssId(s) { return s.replace(/\s+/g,'_'); }
    function areaToAcre(val, unit) {
      const v = parseFloat(val || 0);
      if (!v) return 0;
      return unit === 'hectare' ? v * 2.47105 : v;
    }

    function renderSoilGrid() {
      const sg = document.getElementById('sg');
      sg.innerHTML = '';
      Object.keys(so).forEach(key => {
        const s = so[key];
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.soil = key;
        card.innerHTML = `
          <div class="checkmark">‚úì</div>
          <h3>${s.n}</h3>
          <p>${s.de}</p>
        `;
        card.addEventListener('click', () => {
          document.querySelectorAll('#sg .card').forEach(c => c.classList.remove('selected'));
          card.classList.add('selected');
          d.s = key;
        });
        sg.appendChild(card);
      });
    }

    function renderCropGrid() {
      const cg = document.getElementById('cg');
      cg.innerHTML = '';
      const si = document.getElementById('si');
      const sl = document.getElementById('sl');
      const soilKey = d.s;
      const available = soilKey ? so[soilKey].cr : Object.keys(cr);

      available.forEach(name => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.crop = name;
        const hindi = cr[name]?.h || name;
        card.innerHTML = `
          <div class="checkmark">‚úì</div>
          <h3>${name} (${hindi})</h3>
          <p>Select to include in your plan</p>
        `;
        card.addEventListener('click', () => {
          const idx = d.c.indexOf(name);
          if (idx >= 0) {
            d.c.splice(idx,1);
            card.classList.remove('selected');
          } else {
            d.c.push(name);
            card.classList.add('selected');
          }
          if (d.c.length) {
            si.style.display = 'block';
            sl.textContent = d.c.join(', ');
          } else {
            si.style.display = 'none';
            sl.textContent = '';
          }
        });
        cg.appendChild(card);
      });
    }

    function renderAreaInputs() {
      const ai = document.getElementById('ai');
      ai.innerHTML = '';
      if (!d.c.length) {
        ai.innerHTML = '<div class="alert"><strong>‚ÑπÔ∏è</strong> Please select at least one crop.</div>';
        return;
      }
      d.a = d.a || {};
      d.c.forEach(name => {
        const wrap = document.createElement('div');
        wrap.className = 'input-group';
        wrap.innerHTML = `
          <label><strong>${name}</strong> ‚Äî Area per crop:</label>
          <div style="display:flex; gap:10px; align-items:center;">
            <input type="number" min="0" step="0.01" id="area_${cssId(name)}" placeholder="Enter area" value="${d.a[name]?.val || ''}" style="flex:1;">
            <select id="unit_${cssId(name)}" style="max-width:150px;">
              <option value="acre" ${d.a[name]?.unit === 'acre' ? 'selected' : ''}>Acre</option>
              <option value="hectare" ${d.a[name]?.unit === 'hectare' ? 'selected' : ''}>Hectare</option>
            </select>
          </div>
          <small>Tip: 1 Acre = 0.4047 Hectare</small>
        `;
        ai.appendChild(wrap);
      });
    }

    function renderGuide() {
      const ag = document.getElementById('ag');
      const tb = document.getElementById('tb');
      const ar = document.getElementById('ar');
      ag.innerHTML = '';
      tb.innerHTML = '';
      ar.innerHTML = '';

      let totalBudget = 0;

      d.c.forEach(name => {
        const info = cr[name];
        if (!info) return;

        const area = d.a[name] ? areaToAcre(d.a[name].val, d.a[name].unit) : 0;
        const bu = info.bu || {};
        const perAcre = bu.t || 0;
        const cropBudget = perAcre * area;
        totalBudget += cropBudget;

        const section = document.createElement('div');
        section.className = 'crop-section';
        section.innerHTML = `
          <h4>${name} (${info.h || name}) ‚Äî Area: ${area.toFixed(2)} Acre</h4>
          <div class="step"><strong>Steps:</strong> ${info.st.map(s => `<div>‚Ä¢ ${s}</div>`).join('')}</div>
          <div class="step"><strong>Budget per acre (k):</strong>
            <div class="budget-row"><span><strong>Seeds</strong></span><span>${fmtMoney(bu.s||0)}</span></div>
            <div class="budget-row"><span><strong>Fertilizer</strong></span><span>${fmtMoney(bu.f||0)}</span></div>
            <div class="budget-row"><span><strong>Pesticide</strong></span><span>${fmtMoney(bu.p||0)}</span></div>
            <div class="budget-row"><span><strong>Labour</strong></span><span>${fmtMoney(bu.l||0)}</span></div>
            <div class="budget-row"><span><strong>Water/Irrigation</strong></span><span>${fmtMoney(bu.w||0)}</span></div>
            <div class="budget-row total"><span>Total / acre</span><span>${fmtMoney(bu.t||0)}</span></div>
          </div>
          <div class="step"><strong>Crop budget (k):</strong> ${fmtMoney(cropBudget)}</div>
        `;
        ag.appendChild(section);

        if (Array.isArray(info.ta)) {
          info.ta.forEach(t => {
            const r = document.createElement('div');
            r.className = 'reminder' + (t.t.toLowerCase().includes('harvest') ? ' urgent':'');
            r.innerHTML = `<strong>Day ${t.d}:</strong> ${t.t}`;
            ar.appendChild(r);
          });
        }
      });

      tb.innerHTML = `<div class="budget-row total"><span>Total planned budget</span><span>${fmtMoney(totalBudget)}</span></div>`;
    }

    function renderLinks() {
      const container = document.getElementById('links');
      container.innerHTML = '';
      const st = d.st;
      if (!st) return;

      const block = document.createElement('div');
      if (stateLinks[st]) {
        const buyList = stateLinks[st].buy.map(l => `<li><a href="${l.url}" target="_blank" rel="noopener">${l.name}</a></li>`).join('');
        const sellList = stateLinks[st].sell.map(l => `<li><a href="${l.url}" target="_blank" rel="noopener">${l.name}</a></li>`).join('');
        block.innerHTML = `
          <p><strong>State:</strong> ${st}</p>
          <p><strong>Buy inputs:</strong></p>
          <ul>${buyList}</ul>
          <p><strong>Sell produce:</strong></p>
          <ul>${sellList}</ul>
        `;
      } else {
        block.innerHTML = `
          <p>No specific links found for ${st}. Try national platforms:</p>
          <ul>
            <li><a href="https://enam.gov.in" target="_blank" rel="noopener">eNAM</a></li>
            <li><a href="https://iffcobazar.in" target="_blank" rel="noopener">IFFCO eBazar</a></li>
            <li><a href="https://www.bighaat.com" target="_blank" rel="noopener">BigHaat</a></li>
          </ul>
        `;
      }
      container.appendChild(block);
    }

    // ----- Navigation & Actions -----
    function login() {
      const name = document.getElementById('fname').value.trim();
      const phone = document.getElementById('fphone').value.trim();
      const state = document.getElementById('fstate').value;

      if (!name || !state) {
        alert('Please enter your name and select your state.');
        return;
      }

      d.n = name;
      d.ph = phone;
      d.st = state;

      const ui = document.getElementById('userInfo');
      ui.style.display = 'block';
      ui.textContent = `${d.n} ‚Ä¢ ${d.st}${d.ph ? ' ‚Ä¢ ' + d.ph : ''}`;

      renderSoilGrid();
      showPage('p1');
    }

    function gp1() { showPage('p1'); }

    function gp2() {
      if (!d.s) {
        alert('Please select a soil type.');
        return;
      }
      renderCropGrid();
      showPage('p2');
    }

    function gp3() {
      if (!d.c.length) {
        alert('Please select at least one crop.');
        return;
      }
      d.c.forEach(name => {
        if (!d.a[name]) d.a[name] = { val:'', unit:'acre' };
      });
      renderAreaInputs();
      showPage('p3');
    }

    function gp4() {
      let ok = true;
      d.c.forEach(name => {
        const id = cssId(name);
        const val = document.getElementById('area_'+id)?.value;
        const unit = document.getElementById('unit_'+id)?.value || 'acre';
        if (!val || parseFloat(val) <= 0) ok = false;
        d.a[name] = { val: val || 0, unit };
      });
      if (!ok) {
        alert('Please enter area for all selected crops (greater than 0).');
        return;
      }
      renderGuide();
      renderLinks();
      showPage('p4');
    }

    function en() {
      const ar = document.getElementById('ar');
      const msg = document.createElement('div');
      msg.className = 'success';
      msg.innerHTML = '<strong>üîî Reminders enabled!</strong> Keep an eye on your schedule.';
      ar.prepend(msg);
    }

    function rs() {
      d = { n:'', ph:'', st:'', s:'', c:[], a:{} };
      document.getElementById('fname').value = '';
      document.getElementById('fphone').value = '';
      document.getElementById('fstate').value = '';
      document.getElementById('userInfo').style.display = 'none';
      document.getElementById('userInfo').textContent = '';
      document.getElementById('sg').innerHTML = '';
      document.getElementById('cg').innerHTML = '';
      document.getElementById('si').style.display = 'none';
      document.getElementById('sl').textContent = '';
      document.getElementById('ai').innerHTML = '';
      document.getElementById('ag').innerHTML = '';
      document.getElementById('tb').innerHTML = '';
      document.getElementById('ar').innerHTML = '';
      document.getElementById('links').innerHTML = '';
      showPage('p0');
    }
  </script>
</body>
</html>
