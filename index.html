<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thirunelveli AURA - Student Projects</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8">
        <header class="text-center mb-8 md:mb-12">
            <h1 class="text-4xl sm:text-5xl font-bold text-gray-900">Thirunelveli AURA</h1>
            <p class="mt-2 text-lg text-gray-600">A Showcase of Student Web Apps from Vibe Coding</p>
        </header>

        <main id="project-gallery" class="card-container">
            <!-- Loading message -->
            <div id="loading" class="col-span-full text-center text-gray-500">
                <p>Loading projects...</p>
            </div>
            <!-- Projects will be dynamically inserted here -->
        </main>

        <footer class="text-center mt-12 text-gray-500">
            <p>Curated by S. Rathinagiri &copy; 2025</p>
        </footer>
    </div>

    <script>
        // --- GitHub Repository Configuration ---
        const GITHUB_OWNER = 'SRathinaGiri';
        const GITHUB_REPO = 'ThirunelveliAURA';

        // --- Main Function to Fetch and Display Projects ---
        async function loadProjects() {
            const gallery = document.getElementById('project-gallery');
            const loadingIndicator = document.getElementById('loading');
            
            const GITHUB_API_URL = `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/`;
            const LIVE_PAGE_BASE_URL = `https://${GITHUB_OWNER}.github.io/${GITHUB_REPO}/`;

            try {
                const response = await fetch(GITHUB_API_URL);
                if (!response.ok) {
                    throw new Error(`GitHub API error: ${response.status}`);
                }
                const items = await response.json();

                // Filter for directories only, excluding any git submodules or special files
                const projectFolders = items.filter(item => item.type === 'dir');

                if (projectFolders.length === 0) {
                     loadingIndicator.textContent = 'No projects found in the repository.';
                     return;
                }

                // Clear loading indicator
                gallery.innerHTML = '';
                
                // Fetch details for each project folder concurrently
                const projectPromises = projectFolders.map(async (folder) => {
                    try {
                        const folderContentsResponse = await fetch(folder.url);
                        if (!folderContentsResponse.ok) return null;
                        const folderContents = await folderContentsResponse.json();
                        
                        // Find the primary HTML file and the prompt text file
                        const htmlFile = folderContents.find(file => file.name.endsWith('.html'));
                        const promptFile = folderContents.find(file => file.name.toLowerCase() === 'prompt.txt');

                        if (htmlFile) {
                            return {
                                name: folder.name.replace(/-/g, ' '),
                                liveUrl: `${LIVE_PAGE_BASE_URL}${folder.name}/${htmlFile.name}`,
                                promptUrl: promptFile ? promptFile.html_url : folder.html_url,
                                repoUrl: folder.html_url,
                            };
                        }
                        return null;
                    } catch (error) {
                        console.error(`Error fetching contents for ${folder.name}:`, error);
                        return null;
                    }
                });

                const projects = (await Promise.all(projectPromises)).filter(p => p !== null);
                
                // Render project cards
                projects.forEach(project => {
                    const card = document.createElement('div');
                    card.className = 'bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-lg transition-shadow duration-300 flex flex-col';
                    card.innerHTML = `
                        <div class="p-5 flex-grow">
                            <h2 class="text-xl font-semibold text-gray-800 capitalize">${project.name}</h2>
                        </div>
                        <div class="p-5 bg-gray-50 border-t border-gray-200 grid grid-cols-2 gap-3 text-sm">
                             <a href="${project.liveUrl}" target="_blank" rel="noopener noreferrer" class="text-center font-medium bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 transition-colors">
                                View App
                            </a>
                            <a href="${project.promptUrl}" target="_blank" rel="noopener noreferrer" class="text-center font-medium bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 transition-colors">
                                View Prompt
                            </a>
                        </div>
                    `;
                    gallery.appendChild(card);
                });


            } catch (error) {
                console.error('Failed to load projects:', error);
                loadingIndicator.textContent = 'Failed to load projects. Please check the console for details.';
                loadingIndicator.classList.add('text-red-500');
            }
        }

        // --- Run the script on page load ---
        document.addEventListener('DOMContentLoaded', loadProjects);
    </script>

</body>
</html>
